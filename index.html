<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Urban Girl Shop</title>
    <link rel="icon" type="image/png" href="icono.png" />
    <link rel="stylesheet" href="style.css" />

    <style>
        /* --- ESTILOS PARA EL CENTRADO DE LA TARJETA (CORRECCI√ìN) --- */
        .product-card {
            display: flex; /* Habilitar Flexbox */
            flex-direction: column; /* Apilar elementos verticalmente */
            align-items: center; /* Centrar horizontalmente todo el contenido */
            text-align: center; /* Centrar texto (h4, p) */
        }
        
        .stock-info {
            font-size: 0.9em;
            color: #888;
            margin-bottom: 5px;
            width: 100%; /* Asegura que ocupe todo el ancho para el centrado */
        }
        .out-of-stock {
            color: #d9534f;
            font-weight: bold;
        }
        /* Peque√±o estilo para que .show funcione si lo usas */
        #main { transition: opacity 0.3s ease; opacity: 0; }
        #main.show { opacity: 1; }
        /* Deshabilitar bot√≥n visual */
        button[disabled] { opacity: 0.6; cursor: not-allowed; }

        /* --- ESTILOS PARA REVIEWS Y ESTRELLAS --- */
        .rating {
            color: darkgoldenrod; 
            font-size: 1.1em;
            margin-bottom: 5px;
            letter-spacing: 1px;
        }
        .review-container {
            height: 35px; 
            overflow: hidden;
            margin: 5px 0 10px 0;
            padding: 5px;
            background-color: #f9f9f9;
            border-radius: 4px;
            border: 1px solid #eee;
        }
        .review-carousel {
            position: relative;
            transition: transform 0.5s ease-in-out;
            height: 100%;
        }
        .review-comment {
            font-size: 0.75em;
            color: #555;
            text-align: center;
            line-height: 1.2;
            padding: 0 5px;
            width: 100%; 
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .review-carousel > div {
             flex-shrink: 0;
        }
        
        /* --- ESTILOS DEL BOT√ìN/ENLACE DE NOTIFICACI√ìN (CENTRALIZACI√ìN) --- */
        
        /* Contenedor que mantiene el espacio constante para el bot√≥n o el enlace */
        [data-notify-container] {
            height: 40px; /* Altura aproximada del bot√≥n para evitar saltos */
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
        }
        
        /* Bot√≥n de a√±adir (asegurar que est√© centrado por Flexbox) */
        .add-to-cart {
            display: block;
            margin: 0; /* Quitamos el margin auto que podr√≠a interferir con Flexbox */
        }
        
        /* El enlace de notificaci√≥n */
        .notify-link {
            font-size: 0.9em;
            color: var(--color-principal); 
            text-decoration: underline;
            cursor: pointer;
            text-align: center;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <div id="loader">
        <img src="logoinicio.png" alt="Cargando..." />
    </div>

    <div id="main">
        <header class="main-header">
            <div class="logo">
                <a href="urban.html">
                    <img src="logo5.png" alt="Urban Girl Shop Logo" class="header-logo" />
                </a>
            </div>

            <nav class="main-nav">
                <a href="#novedades">Novedades</a>
                <a href="#vestidos">Vestidos</a>
                <a href="#accesorios">Accesorios</a>
                <a href="#ofertas">Ofertas</a>
            </nav>

            <div class="header-actions">
                <form class="search-form" onsubmit="return false;">
                    <input type="search" placeholder="Buscar..." aria-label="Buscar productos" />
                    <button type="submit">üîç</button>
                </form>
            </div>

            <div class="header-actions">
                <a href="carrito.html" class="cart-button">üõçÔ∏è Carrito (0)</a>
            </div>

            <div class="header-actions">
                <a href="cuentas.html" class="account-link">üë§ Cuenta</a>
            </div>
        </header>

        <section class="hero-banner">
            <h2>Tu Estilo, Tu Actitud. Moda para J√≥venes y Adultas.</h2>
            <p>Descubre las tendencias m√°s *chic* con nuestra paleta pastel.</p>
            <a href="#novedades" class="cta-button">Descubre las Novedades</a>
        </section>

        <main class="store-content">

            <section class="category-section" id="novedades">
                <h2>Novedades *Trending* de la Temporada</h2>
                <div class="product-grid">

                    <article class="product-card" data-sku="SKU-0001">
                        <img src="blusa.jpg" alt="Blusa en Rosa" />
                        <h4>Blusa de Gasa Rosa</h4>
                        <p class="price">$25.000 CLP</p>
                        <div class="rating" data-rating-stars></div>
                        <div class="review-container">
                            <div class="review-carousel"></div>
                        </div>
                        <div class="stock-info">Stock: <span class="product-stock"></span></div>
                        <button class="add-to-cart">A√±adir al Carrito</button>
                        <div data-notify-container></div>
                    </article>

                    <article class="product-card" data-sku="SKU-0002">
                        <img src="falda.jpg" alt="Falda Plisada Menta" />
                        <h4>Falda Plisada Menta</h4>
                        <p class="price">$32.990 CLP</p>
                        <div class="rating" data-rating-stars></div>
                        <div class="review-container">
                            <div class="review-carousel"></div>
                        </div>
                        <div class="stock-info">Stock: <span class="product-stock"></span></div>
                        <button class="add-to-cart">A√±adir al Carrito</button>
                         <div data-notify-container></div>
                    </article>

                </div>
            </section>

            <section class="category-section" id="vestidos">
                <h2>Vestidos: Perfectos para el D√≠a y la Noche</h2>
                <div class="product-grid">

                    <article class="product-card" data-sku="SKU-0003">
                        <img src="vestido.jpg" alt="Vestido Verano" />
                        <h4>Vestido de Lino Liviano</h4>
                        <p class="price">$45.000 CLP</p>
                        <div class="rating" data-rating-stars></div>
                        <div class="review-container">
                            <div class="review-carousel"></div>
                        </div>
                        <div class="stock-info">Stock: <span class="product-stock"></span></div>
                        <button class="add-to-cart">A√±adir al Carrito</button>
                         <div data-notify-container></div>
                    </article>

                </div>
            </section>

            <section class="category-section" id="accesorios">
                <h2>Accesorios para un *Look* 100% Urbano</h2>
                <div class="product-grid">

                    <article class="product-card" data-sku="SKU-0004">
                        <img src="bolso.png" alt="Mini Bolso" />
                        <h4>Mini Bolso Cruzado</h4>
                        <p class="price">$18.500 CLP</p>
                        <div class="rating" data-rating-stars></div>
                        <div class="review-container">
                            <div class="review-carousel"></div>
                        </div>
                        <div class="stock-info">Stock: <span class="product-stock"></span></div>
                        <button class="add-to-cart">A√±adir al Carrito</button>
                         <div data-notify-container></div>
                    </article>

                </div>
            </section>

        </main>

        <footer>
            <p>&copy; 2025 Urban Girl Shop. Moda Femenina Joven y Contempor√°nea.</p>
        </footer>
    </div>

    <script>
        // LOADER: mantiene 2 segundos
        window.addEventListener("load", () => {
            const loader = document.getElementById("loader");
            const main = document.getElementById("main");

            setTimeout(() => {
                loader.style.opacity = "0";
                loader.style.visibility = "hidden";
                main.classList.add("show");
            }, 2000); 
        });
    </script>

    <script>
        // --- CONFIGURACI√ìN ---
        const NOTIFY_FORM_URL = "https://forms.gle/c334K3Vb7Lw6Bxd48"; // Tu enlace de Google Forms

        // --- DATOS DE REVIEWS ---
        const productReviews = {
            "SKU-0001": {
                rating: 4.5,
                comments: [
                    "S√∫per fresca y el color es id√©ntico a la foto. ¬°Me encant√≥!",
                    "Ideal para la oficina. La tela es muy suave. ‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è",
                    "Lleg√≥ en 2 d√≠as. La recomiendo totalmente.",
                    "El calce es perfecto y la gasa se ve de calidad.",
                    "Muy combinable, la mejor blusa de mi armario.",
                    "Un b√°sico elegante que no puede faltar."
                ]
            },
            "SKU-0002": {
                rating: 4.8,
                comments: [
                    "¬°La falda m√°s c√≥moda que he comprado! El plisado se mantiene perfecto.",
                    "El color menta es precioso, combina con todo.",
                    "La ped√≠ para un evento y fue un √©xito.",
                    "El largo es justo el que quer√≠a, muy juvenil.",
                    "No se arruga f√°cil, ideal para viajar.",
                    "Excelente relaci√≥n calidad-precio. Me la comprar√≠a en todos los colores."
                ]
            },
            "SKU-0003": {
                rating: 5.0,
                comments: [
                    "Es tan liviano que no se siente. Perfecto para el calor.",
                    "Calidad premium, vale cada peso. ¬°Mi favorito de Urban Girl!",
                    "El corte es muy elegante y juvenil a la vez.",
                    "Lo he lavado varias veces y sigue como nuevo. Incre√≠ble.",
                    "Recibo cumplidos cada vez que lo uso. ¬°Dise√±o √∫nico!",
                    "Simplemente espectacular. Un 10/10 en comodidad y estilo."
                ]
            },
            "SKU-0004": {
                rating: 4.2,
                comments: [
                    "Tama√±o perfecto para el celular y llaves. Muy pr√°ctico.",
                    "El material es resistente y el dise√±o es muy cute.",
                    "Lo uso a diario, es el accesorio que me faltaba.",
                    "El cierre es de buena calidad, no se traba.",
                    "Se ve m√°s peque√±o en la foto, pero le cabe lo esencial.",
                    "Lleg√≥ bien embalado y muy r√°pido."
                ]
            }
        };

        function getStarHTML(rating) {
            const fullStar = "‚òÖ"; 
            const emptyStar = "‚òÜ"; 
            let html = '';
            const roundedRating = Math.round(rating * 2) / 2;

            for (let i = 1; i <= 5; i++) {
                if (i <= roundedRating) {
                    html += fullStar; 
                } else if (i - 0.5 === roundedRating) {
                    html += '¬Ω';
                } else {
                    html += emptyStar; 
                }
            }
            return html;
        }

        function renderReviews() {
            document.querySelectorAll(".product-card").forEach(card => {
                const sku = card.dataset.sku;
                const data = productReviews[sku];
                if (!data) return;

                const ratingDiv = card.querySelector('[data-rating-stars]');
                if (ratingDiv) {
                    ratingDiv.textContent = getStarHTML(data.rating);
                }

                const carouselContainer = card.querySelector('.review-carousel');
                if (carouselContainer) {
                    carouselContainer.innerHTML = '';
                    data.comments.forEach(comment => {
                        const commentDiv = document.createElement('div');
                        commentDiv.className = 'review-comment';
                        commentDiv.textContent = comment;
                        carouselContainer.appendChild(commentDiv);
                    });
                }
            });
        }
        
        function startReviewCarousels() {
            document.querySelectorAll('.review-container').forEach(container => {
                const carousel = container.querySelector('.review-carousel');
                const comments = carousel.querySelectorAll('.review-comment');
                if (comments.length <= 1) return;

                let currentCommentIndex = 0;
                const commentHeight = container.offsetHeight; 

                carousel.style.height = `${commentHeight * comments.length}px`;

                setInterval(() => {
                    currentCommentIndex = (currentCommentIndex + 1) % comments.length;
                    
                    const translateY = -currentCommentIndex * commentHeight;
                    carousel.style.transition = 'transform 0.8s ease-in-out';
                    carousel.style.transform = `translateY(${translateY}px)`;
                }, 5000); 
            });
        }


        // --- L√ìGICA DE STOCK Y CARRITO ---
        document.addEventListener("DOMContentLoaded", () => {
            
            // Renderizar reviews
            renderReviews();
            startReviewCarousels();

            // STOCK INICIAL (maestro)
            const initialStock = {
                "SKU-0001": 30,
                "SKU-0002": 25,
                "SKU-0003": 15,
                "SKU-0004": 50
            };

            const storedStock = JSON.parse(sessionStorage.getItem("productStock") || "null");
            const stock = Object.assign({}, initialStock, storedStock || {});

            const cart = JSON.parse(sessionStorage.getItem("shoppingCart") || "{}");

            const productCards = document.querySelectorAll(".product-card");
            const cartButton = document.querySelector(".cart-button");

            function updateCartCounter() {
                const total = Object.values(cart).reduce((acc, qty) => acc + qty, 0);
                if (cartButton) cartButton.textContent = `üõçÔ∏è Carrito (${total})`;
                sessionStorage.setItem("shoppingCart", JSON.stringify(cart));
                sessionStorage.setItem("productStock", JSON.stringify(stock));
            }

            // Dibuja el stock en la tarjeta y ajusta el bot√≥n
            function updateStockDisplay(card, units) {
                const span = card.querySelector('.product-stock');
                const button = card.querySelector('.add-to-cart');
                const notifyContainer = card.querySelector('[data-notify-container]'); 
                const sku = card.dataset.sku;
                const qtyInCart = cart[sku] || 0;

                // Limpiar contenedor de notificaci√≥n
                notifyContainer.innerHTML = ''; 

                if (units <= 0) {
                    span.textContent = "‚ùå Agotado";
                    span.classList.add("out-of-stock");
                    span.classList.remove("low-stock");
                    button.style.display = 'none'; // Ocultar bot√≥n de A√±adir
                    
                    // Insertar enlace de notificaci√≥n
                    notifyContainer.innerHTML = `
                        <a href="${NOTIFY_FORM_URL}" target="_blank" class="notify-link">
                            Notificarme cuando haya stock
                        </a>
                    `;

                    return;
                }

                // Si hay stock
                button.style.display = 'block'; // Mostrar bot√≥n de A√±adir
                span.classList.remove("out-of-stock");
                
                if (units <= 5) {
                    span.textContent = `‚ö†Ô∏è ¬°Pocas unidades! (${units})`;
                    span.classList.add("low-stock");
                } else {
                    span.textContent = units;
                    span.classList.remove("low-stock");
                }

                button.disabled = false;
                button.textContent = qtyInCart > 0 
                    ? `A√±adir (${qtyInCart} en Carrito)`
                    : "A√±adir al Carrito";
            }

            // Inicializar todas las tarjetas: mostrar stock y a√±adir listeners
            productCards.forEach(card => {
                const sku = card.dataset.sku;
                if (!sku) return;

                if (typeof stock[sku] !== "number") stock[sku] = 0;

                updateStockDisplay(card, stock[sku]);

                const btn = card.querySelector(".add-to-cart");
                if (!btn) return;

                btn.addEventListener("click", () => {
                    if (stock[sku] > 0) {
                        stock[sku] = stock[sku] - 1;
                        cart[sku] = (cart[sku] || 0) + 1;

                        updateStockDisplay(card, stock[sku]);
                        updateCartCounter();
                    }
                });
            });

            // Refrescar stock al cargar
            productCards.forEach(card => {
                const sku = card.dataset.sku;
                updateStockDisplay(card, stock[sku]);
            });

            // Finalmente actualizamos contador al cargar
            updateCartCounter();
        });
    </script>
</body>
</html>